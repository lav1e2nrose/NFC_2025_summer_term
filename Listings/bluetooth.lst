C51 COMPILER V9.60.7.0   BLUETOOTH                                                         09/05/2025 15:34:41 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE BLUETOOTH
OBJECT MODULE PLACED IN .\Objects\bluetooth.obj
COMPILER INVOKED BY: E:\Keil\C51\BIN\C51.EXE bluetooth.c COMPACT OPTIMIZE(8,SPEED) BROWSE INCDIR(C:\Program Files\Keil_v
                    -5\C51\INC) DEBUG OBJECTEXTEND PRINT(.\Listings\bluetooth.lst) TABS(2) OBJECT(.\Objects\bluetooth.obj)

line level    source

   1          #include "bluetooth.h"
   2          #include "AT24C02.h"
   3          
   4          // 蓝牙模块初始化
   5          void BT_Init(void)
   6          {
   7   1          // 设置蓝牙通信引脚初始状态
   8   1          BT_TX = 1;  // 空闲状态为高电平
   9   1          
  10   1          // 蓝牙模块一般在上电后自动进入AT命令模式或通信模式
  11   1          // 此处可以通过发送一些AT命令来配置蓝牙模块
  12   1          delay_ms(500);  // 等待蓝牙模块稳定
  13   1      }
  14          
  15          // 发送一个字节数据（软件模拟UART发送）
  16          void BT_SendByte(unsigned char dat)
  17          {
  18   1          unsigned char i;
  19   1          
  20   1          // 发送起始位
  21   1          BT_TX = 0;
  22   1          delay_ms(1);  // 延时约9600bps的一位时间，使用delay_ms代替delay_us
  23   1          
  24   1          // 发送8位数据位
  25   1          for(i = 0; i < 8; i++)
  26   1          {
  27   2              BT_TX = (dat & 0x01) ? 1 : 0;  // 从低位开始发送
  28   2              dat >>= 1;
  29   2              delay_ms(1);
  30   2          }
  31   1          
  32   1          // 发送停止位
  33   1          BT_TX = 1;
  34   1          delay_ms(1);
  35   1      }
  36          
  37          // 发送字符串
  38          void BT_SendString(unsigned char *str)
  39          {
  40   1          while(*str)
  41   1          {
  42   2              BT_SendByte(*str++);
  43   2          }
  44   1      }
  45          
  46          // 发送卡信息到蓝牙
  47          void BT_SendCardInfo(void)
  48          {
  49   1          unsigned char i;
  50   1          CARD card;
  51   1          
  52   1          BT_SendString("Card Info in EEPROM:\r\n");
  53   1          
  54   1          // 从EEPROM读取所有卡片信息并通过蓝牙发送
C51 COMPILER V9.60.7.0   BLUETOOTH                                                         09/05/2025 15:34:41 PAGE 2   

  55   1          for(i = 0; i < 3; i++)
  56   1          {
  57   2              AT24C02_ReadCard_pos(i, &card);
  58   2              
  59   2              // 发送卡片序号
  60   2              BT_SendString("Card ");
  61   2              BT_SendByte('1' + i);
  62   2              BT_SendString(": ");
  63   2              
  64   2              // 发送卡ID
  65   2              BT_SendString("ID=");
  66   2              BT_SendString(card.id);
  67   2              BT_SendString(", ");
  68   2              
  69   2              // 发送学号
  70   2              BT_SendString("Student ID=");
  71   2              BT_SendString(card.stuid);
  72   2              BT_SendString("\r\n");
  73   2              
  74   2              delay_ms(100);  // 短暂延时，避免数据发送太快
  75   2          }
  76   1          
  77   1          BT_SendString("Transfer complete.\r\n");
  78   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    259    ----
   CONSTANT SIZE    =     75    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----      26
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
